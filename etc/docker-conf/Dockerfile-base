# recreate with:
#   docker build -f etc/docker-conf/Dockerfile-base -t=pombase/web-base:v3 .
FROM bitnami/minideb:jessie
LABEL maintainer="Kim Rutherford <kim@pombase.org>"

RUN mkdir /downloads /pombase

ENV DEBIAN_FRONTEND=noninteractive

RUN echo "deb http://http.debian.net/debian jessie-backports main" > /etc/apt/sources.list.d/jessie-backports.list
RUN apt-get -y update && apt-get -y dist-upgrade && apt-get clean
RUN apt-get -y install apt-utils curl gnupg2 git-core \
  libterm-readline-gnu-perl pkg-config libssl-dev && apt-get clean
RUN cd /pombase && curl https://www-eu.apache.org/dist/lucene/solr/6.6.1/solr-6.6.1.tgz | tar xzf -

RUN apt-get -y install jq gcc && apt-get clean
RUN apt-get -y install --reinstall python-pkg-resources && apt-get clean
RUN apt-get -y install python3-pip && apt-get clean
RUN apt-get -y install -t jessie-backports openjdk-8-jre-headless && apt-get clean
RUN apt-get -y install python3-zmq && apt-get clean
RUN pip3 install circus

RUN curl -sL https://deb.nodesource.com/setup_8.x | bash -
RUN apt-get update && apt-get -y install nodejs && apt-get clean
RUN npm install --silent --unsafe-perm -g @angular/cli

WORKDIR /pombase

ENV DEBIAN_FRONTEND=interactive
